import"./modulepreload-polyfill-B5Qt9EMX.js";const M="http://api.relda.com.br",P=document.getElementById("registration-form"),w=document.getElementById("company-section"),B=document.getElementById("admin-section"),$=document.getElementById("next-to-admin"),N=document.getElementById("back-to-company"),g=document.getElementById("register-button"),p=document.getElementById("button-text"),y=document.getElementById("button-loading"),f=document.getElementById("error-message"),D=document.getElementById("error-text"),F=document.getElementById("success-modal"),O=document.getElementById("countdown"),c=document.getElementById("password"),i=document.getElementById("confirm-password"),_=document.getElementById("toggle-password"),z=document.getElementById("toggle-confirm-password"),h=document.getElementById("password-match"),E=document.getElementById("password-mismatch"),v=document.getElementById("cnpj"),d=document.getElementById("password-strength"),n=document.getElementById("password-strength-text"),I=document.getElementById("phone");v&&IMask(v,{mask:"00.000.000/0000-00"});I&&IMask(I,{mask:"(00) 00000-0000"});function L(e,t){t.addEventListener("click",function(){const o=e.getAttribute("type")==="password"?"text":"password";e.setAttribute("type",o),this.querySelector("svg").classList.toggle("text-gray-700")})}L(c,_);L(i,z);function u(){return c.value&&i.value?c.value===i.value?(h.classList.remove("hidden"),E.classList.add("hidden"),!0):(h.classList.add("hidden"),E.classList.remove("hidden"),!1):!1}function U(){const e=c.value;let t=0;if(e.length>=8&&t++,e.length>=12&&t++,/[A-Z]/.test(e)&&t++,/[a-z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[^A-Za-z0-9]/.test(e)&&t++,d.classList.remove("weak","fair","good","strong"),n.classList.remove("text-red-500","text-yellow-500","text-blue-500","text-green-500"),e.length===0){n.textContent="";return}switch(t){case 0:case 1:case 2:d.classList.add("weak"),n.textContent="Senha fraca",n.classList.add("text-red-500");break;case 3:d.classList.add("fair"),n.textContent="Senha média",n.classList.add("text-yellow-500");break;case 4:case 5:d.classList.add("good"),n.textContent="Senha boa",n.classList.add("text-blue-500");break;case 6:d.classList.add("strong"),n.textContent="Senha forte",n.classList.add("text-green-500");break}}c.addEventListener("input",()=>{u(),U()});i.addEventListener("input",u);$.addEventListener("click",function(e){if(e.preventDefault(),!document.getElementById("company-name").value.trim()){l("Por favor, informe o nome da empresa.");return}w.classList.add("hidden"),B.classList.remove("hidden")});N.addEventListener("click",function(e){e.preventDefault(),B.classList.add("hidden"),w.classList.remove("hidden")});function l(e){D.textContent=e,f.classList.remove("hidden"),setTimeout(()=>{f.classList.add("hidden")},5e3)}function Z(e){let t="";for(const o in e){const s=e[o];if(typeof s=="object"&&!Array.isArray(s))for(const r in s)t+=`${r}: ${s[r].join(", ")} `;else t+=`${o}: ${s.join(", ")} `}return t}P.addEventListener("submit",async function(e){if(e.preventDefault(),!u()){l("As senhas não coincidem.");return}const t=document.getElementById("company-name").value.trim(),o=document.getElementById("cnpj").value.trim(),s=document.getElementById("business-area").value,r=document.getElementById("first-name").value.trim(),b=document.getElementById("last-name").value.trim(),x=document.getElementById("phone").value.replace(/\D/g,""),k=document.getElementById("email").value.trim(),S=document.getElementById("password").value,A={email:k,password:S,first_name:r,last_name:b,phone:`+55${x}`,company:{name:t,cnpj:o,business_area:s}};p.classList.add("hidden"),y.classList.remove("hidden"),g.disabled=!0;try{const a=await fetch(`${M}/api/accounts/register/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}),C=await a.json();if(!a.ok){const T=Z(C);throw new Error(`Ocorreu um erro. ${T}`)}F.classList.remove("hidden");let m=5;const j=setInterval(()=>{m--,O.textContent=m,m<=0&&(clearInterval(j),window.location.href="./login.html")},1e3)}catch(a){l(a.message),console.error("Fetch error:",a)}finally{p.classList.remove("hidden"),y.classList.add("hidden"),g.disabled=!1}});
