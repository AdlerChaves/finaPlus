import"./modulepreload-polyfill-B5Qt9EMX.js";import{p as B,r as L}from"./topBar-DJwU6RwO.js";const d="https://www.relda.com.br",D=JSON.parse(localStorage.getItem("userData"));document.addEventListener("DOMContentLoaded",()=>{B("cadastros"),L("cadastros",D.permissions_list),p()});const h=document.getElementById("form-section"),m=document.getElementById("category-form"),E=document.getElementById("category-id"),$=document.getElementById("category-name"),C=document.getElementById("category-type"),_=document.getElementById("category-dre"),T=document.getElementById("category-dfc");document.getElementById("submit-btn-text");const k=document.getElementById("form-title"),F=document.getElementById("new-category-btn"),M=document.getElementById("empty-state-btn"),S=document.getElementById("cancel-btn"),g=document.getElementById("categories-table-body"),f=document.getElementById("mobile-categories-list"),y=document.getElementById("empty-state"),b=document.getElementById("pagination"),N=document.getElementById("confirm-modal"),j=document.getElementById("confirm-delete"),O=document.getElementById("cancel-delete"),x=document.getElementById("success-toast"),A=document.getElementById("toast-message");let l=null;async function p(){try{const e=await fetch(`${d}/api/finance/categories/`,{credentials:"include"});if(!e.ok)throw new Error("Falha ao buscar categorias.");const t=await e.json();P(t)}catch(e){console.error(e),o(e.message,"error")}}async function H(e){e.preventDefault();const t=E.value,c={name:$.value,type:C.value,dre_classification:_.value,dfc_classification:T.value},i=t?`${d}/api/finance/categories/${t}/`:`${d}/api/finance/categories/`,r=t?"PUT":"POST";try{const n=await fetch(i,{method:r,headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)});if(!n.ok){const s=await n.json();let a="Erro ao salvar. ";for(const u in s)a+=`${u}: ${s[u].join(", ")}`;throw new Error(a)}o(t?"Categoria atualizada com sucesso!":"Categoria criada com sucesso!"),w(),p()}catch(n){console.error(n),o(n.message,"error")}}async function R(){if(l)try{if((await fetch(`${d}/api/finance/categories/${l}/`,{method:"DELETE",credentials:"include"})).status!==204)throw new Error("Falha ao excluir a categoria.");o("Categoria excluída com sucesso!"),I(),p()}catch(e){console.error(e),o(e.message,"error")}}function P(e=[]){if(g.innerHTML="",f.innerHTML="",e.length===0){y.classList.remove("hidden"),b.classList.add("hidden");return}y.classList.add("hidden"),b.classList.remove("hidden"),e.forEach(t=>{const c=J(t.dre_classification),i=U(t.dfc_classification),r=t.type==="entrada"?"Entrada":"Saída",n=t.type==="entrada"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",s=document.createElement("tr");s.innerHTML=`
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${t.name}</td>
                <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${n}">${r}</span></td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${c}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${i}</td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                    <button onclick="openEditForm(${t.id})" class="text-fin-blue hover:text-blue-600 mr-4"><i class="fas fa-edit"></i></button>
                    <button onclick="openDeleteModal(${t.id})" class="text-fin-red hover:text-red-600"><i class="fas fa-trash-alt"></i></button>
                </td>
            `,g.appendChild(s);const a=document.createElement("div");a.className="p-4",a.innerHTML=`
    <div class="flex justify-between items-center mb-1">
        <h4 class="text-gray-800 font-semibold text-sm">${t.name}</h4>
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${n}">${r}</span>
    </div>
    <p class="text-sm text-gray-500"><strong>DRE:</strong> ${c}</p>
    <p class="text-sm text-gray-500"><strong>DFC:</strong> ${i}</p>
    <div class="mt-2 flex justify-end space-x-3">
        <button onclick="openEditForm(${t.id})" class="text-fin-blue hover:text-blue-600"><i class="fas fa-edit"></i></button>
        <button onclick="openDeleteModal(${t.id})" class="text-fin-red hover:text-red-600"><i class="fas fa-trash-alt"></i></button>
    </div>
`,f.appendChild(a)})}function J(e){return{receita_bruta:"Receita Bruta",deducao_venda:"Dedução de Venda",custos_variaveis:"Custos Variáveis",despesa_operacional:"Despesa Operacional",despesa_administrativa:"Despesa Administrativa",despesa_comercial:"Despesa Comercial",receita_financeira:"Receita Financeira",despesa_financeira:"Despesa Financeira",imposto_lucro:"Imposto sobre o Lucro",investimento:"Investimento",nao_se_aplica:"Não se Aplica"}[e]||e}function U(e){return{operacional:"Operacional",investimento:"Investimento",financiamento:"Financiamento",nao_se_aplica:"Não se Aplica"}[e]||e}function v(){h.classList.remove("hidden"),k.textContent="Nova Categoria",m.reset(),E.value=""}function w(){h.classList.add("hidden"),m.reset()}function I(){l=null,N.classList.add("hidden")}function o(e,t="success"){A.textContent=e,x.className=`fixed bottom-4 right-4 text-white px-4 py-2 rounded-md shadow-lg toast ${t==="success"?"bg-green-500":"bg-red-500"}`,setTimeout(()=>{x.className="hidden"},3e3)}F.addEventListener("click",v);M.addEventListener("click",v);m.addEventListener("submit",H);S.addEventListener("click",w);j.addEventListener("click",R);O.addEventListener("click",I);
