import"./modulepreload-polyfill-B5Qt9EMX.js";const g="https://www.relda.com.br",u=document.getElementById("reset-form"),h=document.getElementById("token-input"),l=document.getElementById("message-area"),a=document.getElementById("submit-button"),m=document.getElementById("new-password"),f=document.getElementById("password-strength-bar"),w=document.getElementById("password-strength-text");function p(d,e,t){const s=d.value;let n=0;if(s.length>=8&&n++,s.length>=12&&n++,/[A-Z]/.test(s)&&n++,/[a-z]/.test(s)&&n++,/[0-9]/.test(s)&&n++,/[^A-Za-z0-9]/.test(s)&&n++,e.className="h-1 rounded-full transition-all duration-300",t.textContent="",t.className="text-xs",s.length!==0)switch(n){case 0:case 1:case 2:e.classList.add("bg-red-500","w-1/4"),t.textContent="Senha fraca",t.classList.add("text-red-500");break;case 3:e.classList.add("bg-yellow-500","w-1/2"),t.textContent="Senha média",t.classList.add("text-yellow-500");break;case 4:case 5:e.classList.add("bg-blue-500","w-3/4"),t.textContent="Senha boa",t.classList.add("text-blue-500");break;case 6:e.classList.add("bg-green-500","w-full"),t.textContent="Senha forte",t.classList.add("text-green-500");break}}m.addEventListener("input",()=>{p(m,f,w)});window.addEventListener("DOMContentLoaded",()=>{const e=new URLSearchParams(window.location.search).get("token");e?h.value=e:(c("Token de redefinição inválido ou ausente.","error"),u.classList.add("hidden"))});function c(d,e){l.textContent=d,l.className=`p-4 mb-4 rounded ${e==="success"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,l.classList.remove("hidden")}u.addEventListener("submit",function(d){d.preventDefault(),a.disabled=!0,a.textContent="Salvando...";const e=document.getElementById("new-password").value,t=document.getElementById("confirm-password").value,s=h.value;if(e!==t){c("As senhas não coincidem.","error"),a.disabled=!1,a.textContent="Salvar Nova Senha";return}if(e.length<8){c("A senha deve ter pelo menos 8 caracteres.","error"),a.disabled=!1,a.textContent="Salvar Nova Senha";return}const n={token:s,password:e};fetch(`${g}/api/accounts/password_reset/confirm/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(async r=>{const o=await r.json();if(!r.ok){let i="Ocorreu um erro. ";throw o.password&&(i+=`Senha: ${o.password.join(" ")}. `),o.token&&(i+=`Token: ${o.token.join(" ")}. `),o.status&&(i+=o.status),new Error(i.trim())}return o}).then(r=>{u.classList.add("hidden"),c("Senha redefinida com sucesso! Você já pode fazer o login com sua nova senha.","success")}).catch(r=>{c(r.message,"error")}).finally(()=>{a.disabled=!1,a.textContent="Salvar Nova Senha"})});
